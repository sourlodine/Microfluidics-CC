<?xml version="1.0"?>
<simulation name="couette" logfile="log" mpi_ranks="1 1 1" debug_lvl="2">

	<domain size="32 32 68" />
	
	<particle_vector type="regular" name="dpd" mass="1">
		<generate type="uniform" density="8" />
	</particle_vector>
	
	<!--
		Walls section
	-->
	
	<particle_vector type="regular" name="bot" mass="1">
		<generate type="restart" path="restart/" />
	</particle_vector>
	
	<particle_vector type="regular" name="top" mass="1">
		<generate type="restart" path="restart/" />
	</particle_vector>
	
	<wall type="plane" name="bot" check_every="100" normal="0 0 -1" point_through="0 0 2" >
		<generate_frozen name="bot" path="restart" mass="1.0" density="8" a="25" kbt="0.5" rc="1.0" power="0.5" />
		<apply_to pv="dpd" />
	</wall>
		
	<wall type="oscillating_plane" name="top" check_every="100" normal="0 0 1" point_through="0 0 66" velocity="0.5 0 0" period="100000" >
		<generate_frozen name="top" path="restart" mass="1.0" density="8" a="25" kbt="0.5" rc="1.0" power="0.5" />
		<apply_to pv="dpd" />
	</wall>
	
	
	<!--
		Interactions section
	-->
	
	<interaction type="dpd" name="dpd_int" a="25" gamma="20" kbt="0.5" dt="0.001" rc="1.0" power="0.5">
		<apply_to pv1="dpd" pv2="dpd"/>
		<apply_to pv1="top" pv2="dpd"/>
		<apply_to pv1="bot" pv2="dpd"/>
	</interaction>
	
	
	<!--
		Integrators section
	-->
	
	<integrator type="vv" name="integrate" dt="0.001">
		<apply_to pv="dpd" />
	</integrator>
		
	<integrator type="oscillate" name="osc" dt="0.001" velocity="0.5 0 0" period="100000">
		<apply_to pv="top" />
	</integrator>

	<!--
		Plugins section
	-->
	
	<!-- <plugin type="temperaturize" name="t_top" pv_name="top"  kbt="0.5" />
	<plugin type="temperaturize" name="t_bot" pv_name="bot"  kbt="0.5" /> -->
		
 	<plugin type="dump_avg_flow" name="avg"
		pv_names="dpd"
		sample_every="5" dump_every="5000"
		bin_size="1 1 1"
		path="osc_xdmf/avg_rho_u" />
		
	<plugin type="dump_avg_flow" name="osc"
		pv_names="top"
		sample_every="5" dump_every="5000"
		bin_size="1 1 1"
		path="osc_xdmf/osc" />
		
	<plugin type="stats" name="stats" every="1000" />
	
	<run niters="300010" />
</simulation>

