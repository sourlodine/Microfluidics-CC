<?xml version="1.0"?>
<simulation name="poiseuille" logfile="log" mpi_ranks="1 1 1" debug_lvl="10">

	<domain size="24 24 24" />
	
	<particle_vector type="regular" name="dpd" mass="1">
		<generate type="uniform" density="10" />
	</particle_vector>
	
	<particle_vector type="rigid_ellipsoids" name="ellipsoids" mass="1" particles_per_obj="500" axes="3 4 5" >
		<generate type="read_ellipsoids" ic_filename="ellipsoids.ic" xyz_filename="../../scripts/el_3_4_5_500.xyz" />
	</particle_vector>
	
	<object_belonging_checker name="ell_checker" object_vector="ellipsoids" type="analytical_ellipsoid" >
		<apply_to pv="dpd" inside="dpd2" outside="dpd" check_every="1" />
	</object_belonging_checker>
	
	<!-- <object_bouncer name="ell_bounce" ov="rigid_ellipsoid" type="analytical">
		<apply_to pv="dpd" check="true"/>
	</object_bouncer> -->

	<!-- <particle_vector type="regular" name="frozen" mass="1">
		<generate type="restart" path="restart/" />
	</particle_vector>
	
	<wall type="sdf" name="wall" sdf_filename="../../walls/cylinder_r5_h32.sdf">
		<generate_frozen name="frozen" path="restart" mass="1.0" density="8" a="2.6666667" kbt="0.05" rc="1.0" power="0.5" />
		<apply_to pv="dpd" check="false" />
	</wall> -->
	
	<interaction type="dpd" name="dpd_int" a="2.6666667" gamma="8" kbt="0.0444302" dt="0.0005" rc="1.0" power="0.25">
		<apply_to pv1="dpd" pv2="dpd"/>
		<apply_to pv1="dpd" pv2="ellipsoids"/>
		<apply_to pv1="dpd" pv2="dpd2"/>
	</interaction>
	
	<integrator type="vv_periodic_poiseuille" name="const_dp" direction="x" force="0.0" dt="0.0000">
		<apply_to pv="dpd" />
	</integrator>
	
	<integrator type="rigid_vv" name="rigid" dt="0.0000">
		<apply_to pv="ellipsoids" />
	</integrator>
	
 	<plugin type="dump_avg_flow" name="avg"
		pv_names="dpd"
		sample_every="10000" dump_every="10000"
		bin_size="0.5 0.5 0.5"
		path="xdmf/avg_rho_u" />
	
	<plugin type="dump_xyz" name="solid"
		pv_name="ellipsoids"
		dump_every="100"
		path="xyz/ellipsoids" />
			
	<plugin type="dump_xyz" name="dpd"
		pv_name="dpd"
		dump_every="100"
		path="xyz/dpd_" />
	
	<plugin type="dump_xyz" name="dpd2"
		pv_name="dpd2"
		dump_every="100"
		path="xyz/dpd2_" />
	
	<plugin type="stats" name="stats" every="100" />
	
	<run niters="1000" />

</simulation>

