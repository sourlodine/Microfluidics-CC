<?xml version="1.0"?>
<simulation name="couette" logfile="log" mpi_ranks="1 1 1" debug_lvl="2">

	<domain size="64 64 12" />
	
	<particle_vector type="regular" name="dpd" mass="1">
		<generate type="uniform" density="8" />
	</particle_vector>
	
	<particle_vector type="rbcs" name="rbcs" mass="0.655" particles_per_obj="498" mesh_filename="../../data/rbc_mesh.off" >
		<generate type="read_rbcs" ic_filename="rbcs.ic" mesh_filename="../../data/rbc_mesh.off" />
	</particle_vector>
	
	<!--
		Walls section
	-->
	
	<particle_vector type="regular" name="inner" mass="1">
		<generate type="restart" path="restart/" />
	</particle_vector>
	
	<particle_vector type="regular" name="outer" mass="1">
		<generate type="restart" path="restart/" />
	</particle_vector>
	
	<wall type="cylinder" name="inner" check_every="100" axis="z" radius="10" inside="false" center="32 32" >
		<generate_frozen path="restart" mass="1.0" density="8" a="25" kbt="0.5" rc="1.0" power="0.5" />
		<apply_to pv="dpd" />
	</wall>
		
	<wall type="rotating_cylinder" name="outer" check_every="100" axis="z" radius="30" inside="true" center="32 32" omega="0.01" >
		<generate_frozen path="restart" mass="1.0" density="8" a="25" kbt="0.5" rc="1.0" power="0.5" />
		<apply_to pv="dpd" />
	</wall>
	
	<!--
		Interactions section
	-->
	
	<interaction type="dpd" name="dpd_int" a="25" gamma="20" kbt="0.5" dt="0.001" rc="1.0" power="0.5">
		<apply_to pv1="dpd" pv2="dpd"/>
		<apply_to pv1="inner" pv2="dpd"/>
		<apply_to pv1="outer" pv2="dpd"/>
		<apply_to pv1="rbcs" pv2="dpd"/>
	</interaction>
	
	<interaction type="rbc" name="rbc_int" preset="lina" gammaC="60" >
		<apply_to pv1="rbcs" pv2="rbcs"/>
	</interaction>
	
	<!--
		Integrators section
	-->

	<integrator type="vv" name="integrate" dt="0.001">
		<apply_to pv="dpd" />
		<apply_to pv="rbcs" />
	</integrator>
	
	<integrator type="const_omega" name="rot" dt="0.001" omega="0 0 0.01" center="32 32 8">
		<apply_to pv="outer" />
	</integrator>
	
	
	<!--
		Plugins section
	-->
		
 	<plugin type="dump_avg_flow" name="avg"
		pv_names="dpd"
		sample_every="50" dump_every="50000"
		bin_size="0.5 0.5 1"
		path="tc_xdmf/avg_rho_u" />
		
		
	<plugin type="dump_obj_pos" name="lala"
		ov_name="rbcs"
		dump_every="1000"
		path="tc_pos/" />
		
	<plugin type="dump_xyz" name="rbcs"
		pv_name="rbcs"
		dump_every="2000"
		path="tc_xyz/" />
		
	
	<plugin type="stats" name="stats" every="1000" />
	
	<run niters="5000000" />
</simulation>

